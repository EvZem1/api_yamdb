# Проект YaMDb API

## Описание проекта

**YaMDb** — это бэкенд API для платформы, где пользователи могут публиковать отзывы на различные произведения (фильмы, книги, музыку), ставить им оценки и комментировать чужие отзывы. Сами произведения на платформе не хранятся.

Проект реализует RESTful API для взаимодействия с клиентскими приложениями.

**Основные возможности:**

* Регистрация новых пользователей с подтверждением по email.
* Аутентификация пользователей по JWT-токену.
* Система ролей пользователей (Аноним, Пользователь, Модератор, Администратор) с разными правами доступа к API.
* Полное CRUD-управление (создание, чтение, обновление, удаление) для моделей через API с учетом прав доступа:
    * Произведения (Titles)
    * Категории (Categories)
    * Жанры (Genres)
    * Отзывы (Reviews)
    * Комментарии к отзывам (Comments)
    * Пользователи (Users) - управление через админа и личный кабинет `/users/me/`.
* Автоматический расчет рейтинга произведения на основе пользовательских оценок.
* Возможность фильтрации произведений по категории, жанру, году выпуска и названию.
* Документация API доступна через ReDoc.

## Стек технологий

* Python 3.9+
* Django 3.2+
* Django REST Framework (DRF)
* Simple JWT (для аутентификации)
* SQLite3 (база данных по умолчанию для разработки)
* Gunicorn (рекомендуется для production)
* python-dotenv / os.getenv (для управления переменными окружения)
* Pytest, pytest-django (для тестирования)
* Flake8, isort (для контроля качества кода)

## Установка и запуск проекта локально

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL_вашего_репозитория>
    cd api_yamdb # Или имя папки вашего проекта
    ```

2.  **Создайте и активируйте виртуальное окружение:**
    ```bash
    python -m venv venv
    # Для Linux/macOS:
    source venv/bin/activate
    # Для Windows (cmd.exe):
    # .\venv\Scripts\activate
    # Для Windows (PowerShell):
    # .\venv\Scripts\Activate.ps1
    ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **(Опционально) Настройте переменные окружения:**
    Создайте файл `.env` в корневой папке проекта (`api_yamdb/`) и добавьте необходимые переменные. Как минимум, нужен `SECRET_KEY`. Если планируете использовать реальную отправку email через SMTP, добавьте настройки почты.
    ```.env
    # Обязательно! Сгенерируйте свой надежный ключ
    SECRET_KEY='ваш_секретный_ключ'

    # Настройки почты (если используете SMTP, например, Gmail с паролем приложения)
    # EMAIL_HOST_USER='pedropedrissimo0@gmail.com'
    # EMAIL_HOST_PASSWORD='myti iucl bbsi xyqj' # Пример пароля приложения
    ```
    **Важно:** Добавьте файл `.env` в ваш `.gitignore`, чтобы не публиковать секретные данные.

5.  **Примените миграции базы данных:**
    ```bash
    python manage.py migrate
    ```

6.  **Загрузите начальные данные (Опционально, но рекомендуется):**
    В проекте есть CSV-файлы с тестовыми данными (`static/data/`). Для их загрузки в базу данных используйте специальную management-команду:
    ```bash
    python manage.py load_csv_data
    ```
    Эта команда наполнит таблицы Users, Categories, Genres, Titles, Reviews, Comments.

7.  **Запустите сервер разработки:**
    ```bash
    python manage.py runserver
    ```
    API будет доступно по адресу `http://127.0.0.1:8000/api/v1/`.
    Документация API (ReDoc) будет доступна по адресу `http://127.0.0.1:8000/redoc/`.

## Примеры запросов к API

Полную документацию со всеми эндпоинтами и параметрами смотрите в ReDoc (`/redoc/`).

**1. Регистрация (запрос кода подтверждения):**
```bash
POST /api/v1/auth/signup/
Content-Type: application/json

{
  "email": "user@example.com",
  "username": "string"
}

## Примеры запросов к API

Полную документацию со всеми эндпоинтами и параметрами смотрите в ReDoc (`/redoc/`).

**1. Регистрация (запрос кода подтверждения):**
```bash
POST /api/v1/auth/signup/
Content-Type: application/json

{
  "email": "user@example.com",
  "username": "string"
}
В ответ придет письмо с кодом на указанный email.

2. Получение JWT-токена:

Bash

POST /api/v1/auth/token/
Content-Type: application/json

{
  "username": "string",
  "confirmation_code": "string_из_письма"
}
В ответ придет JSON с токеном:

JSON

{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
3. Получение списка произведений (аутентифицированный запрос):

Bash

GET /api/v1/titles/
Authorization: Bearer <ВАШ_JWT_ТОКЕН>
В ответ придет страница со списком произведений.

Авторы
Землянухин Евгений
